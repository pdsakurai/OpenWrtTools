#Destination file: /etc/init.d/update_ddns
#!/bin/sh /etc/rc.common

NAME="update_ddns"
USE_PROCD=1
START=99

readonly NAME USE_PROCD START

start_service() {
    procd_open_instance
    procd_set_param command /bin/sh "/usr/bin/$NAME"
    procd_append_param env HOST_NAME=$HOST_NAME
    procd_append_param env SECRET_KEY=$SECRET_KEY
    procd_append_param env SOURCES_DIR=/root/OpenWrtTools/src
    procd_close_instance
}

service_triggers() {
    for interface in wan wan6 lan; do
        procd_add_interface_trigger "interface.up" $interface /etc/init.d/$NAME restart
    done
}
